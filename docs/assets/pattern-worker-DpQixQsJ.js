let c=null,f=null,p=null,r=null,l=!1;async function g(){if(!l)try{const e=await import("../../wasm/crochet_wasm.js");await e.default(),c=e.generate_pattern_from_json,f=e.validate_profile,p=e.validate_config,r=e.init_panic_hook,r&&r(),l=!0}catch(e){throw console.error("WASM initialization failed:",e),new Error(`Failed to initialize WASM: ${e.message}`)}}self.onmessage=async e=>{const{id:o,type:s,payload:i}=e.data;try{switch(await g(),s){case"GENERATE_PATTERN":{const{profile:t,config:a}=i;try{const n=c(JSON.stringify(t),JSON.stringify(a)),y=JSON.parse(n);self.postMessage({id:o,type:"SUCCESS",payload:y})}catch(n){throw new Error(`Pattern generation failed: ${n}`)}break}case"VALIDATE_PROFILE":{const a=f(JSON.stringify(i));self.postMessage({id:o,type:"SUCCESS",payload:a});break}case"VALIDATE_CONFIG":{const a=p(JSON.stringify(i));self.postMessage({id:o,type:"SUCCESS",payload:a});break}default:throw new Error(`Unknown action type: ${s}`)}}catch(t){self.postMessage({id:o,type:"ERROR",payload:t.message})}};
